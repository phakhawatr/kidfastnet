// Mixed Math Word Problem Templates - 90+ unique Thai word problems
// Each template is a fixed-number story that returns question, answer, symbolic, hint, ops

export interface TemplateResult {
  question: string;
  answer: number;
  symbolic: string;
  symbolicAlt?: string;
  hint: string;
  ops: string[]; // e.g. ['+','-'] or ['*','/']
}

export type MathTemplate = () => TemplateResult;

// ============================================================
// 2-OP TEMPLATES  (each has exactly 2 operands)
// ============================================================

export const twoOpTemplates: MathTemplate[] = [
  // ─── อาชีพ ───
  // + -
  () => ({ question: 'พนักงานไปรษณีย์ ต้องส่งจดหมาย 500 ซอง ส่งไปแล้วช่วงเช้า 120 ซอง เหลือจดหมายที่ต้องส่งกี่ซอง?', answer: 380, symbolic: '500 - 120 = ?', hint: 'จดหมายทั้งหมด ลบที่ส่งแล้ว', ops: ['-'] }),
  () => ({ question: 'วิศวกร ต้องการวางท่อน้ำยาว 1,000 เมตร วันแรกวางได้ 200 เมตร วันที่สองวางได้มากกว่าวันแรก 50 เมตร เหลือระยะทางที่ต้องวางท่ออีกกี่เมตร?', answer: 550, symbolic: '1,000 - 200 - 250 = ?', symbolicAlt: '1,000 - 200 - (200 + 50) = ?', hint: 'หาวันที่สองก่อน (200+50=250) แล้วลบทั้งสองวันออกจาก 1,000', ops: ['-', '+'] }),
  () => ({ question: 'คุณหมอฟัน มีนัดขูดหินปูน 8 เคส เคสละ 30 นาที และถอนฟัน 2 เคส เคสละ 45 นาที รวมใช้เวลาทำฟันทั้งหมดกี่นาที?', answer: 330, symbolic: '(8 × 30) + (2 × 45) = ?', hint: 'คูณเวลาแต่ละประเภทแล้วบวกรวม', ops: ['+', '*'] }),
  () => ({ question: 'ช่างซ่อมรถ เปลี่ยนยางรถยนต์ 4 เส้น เส้นละ 2,500 บาท และเปลี่ยนถ่ายน้ำมันเครื่องอีก 1,200 บาท ลูกค้าต้องจ่ายเงินรวมกี่บาท?', answer: 11200, symbolic: '(4 × 2,500) + 1,200 = ?', hint: 'คูณค่ายางก่อนแล้วบวกค่าน้ำมัน', ops: ['+', '*'] }),
  () => ({ question: 'สถาปนิก ออกแบบบ้าน 3 หลัง คิดค่าแบบหลังละ 25,000 บาท นำเงินไปซื้อคอมพิวเตอร์ใหม่ 40,000 บาท เหลือเงินกี่บาท?', answer: 35000, symbolic: '(3 × 25,000) - 40,000 = ?', hint: 'คูณรายได้ก่อนแล้วลบค่าใช้จ่าย', ops: ['-', '*'] }),
  () => ({ question: 'ช่างภาพ รับงานถ่ายรูปรับปริญญา 2 วัน วันละ 3,500 บาท หักค่าเดินทาง 500 บาท จะเหลือกำไรกี่บาท?', answer: 6500, symbolic: '(2 × 3,500) - 500 = ?', hint: 'คูณรายได้ก่อนแล้วลบค่าเดินทาง', ops: ['-', '*'] }),
  () => ({ question: 'บรรณารักษ์ จัดหนังสือเข้าชั้นใหม่ 4 ตู้ ตู้ละ 120 เล่ม ยังมีหนังสือเหลือที่พื้นอีก 50 เล่ม รวมมีหนังสือใหม่กี่เล่ม?', answer: 530, symbolic: '(4 × 120) + 50 = ?', hint: 'คูณจำนวนหนังสือในตู้แล้วบวกที่เหลือ', ops: ['+', '*'] }),
  () => ({ question: 'นักร้อง เปิดคอนเสิร์ตขายบัตรใบละ 500 บาท ขายได้ 200 ใบ นำเงินไปบริจาคครึ่งหนึ่ง จะเหลือเงินกี่บาท?', answer: 50000, symbolic: '(500 × 200) ÷ 2 = ?', hint: 'คูณรายได้ทั้งหมดแล้วหารด้วย 2', ops: ['*', '/'] }),
  () => ({ question: 'นางพยาบาล ต้องวัดไข้คนไข้ตึก A จำนวน 40 คน และตึก B จำนวน 35 คน โดยใช้เวลาคนละ 2 นาที รวมใช้เวลาวัดไข้กี่นาที?', answer: 150, symbolic: '(40 + 35) × 2 = ?', hint: 'รวมจำนวนคนไข้ทั้งสองตึกก่อนแล้วคูณเวลา', ops: ['+', '*'] }),
  () => ({ question: 'คนขับแท็กซี่ ขับรถส่งผู้โดยสาร 10 เที่ยว ได้ค่าโดยสารเที่ยวละ 120 บาท แต่ต้องจ่ายค่าแก๊ส 400 บาท เหลือเงินกลับบ้านกี่บาท?', answer: 800, symbolic: '(10 × 120) - 400 = ?', hint: 'คูณรายได้ก่อนแล้วลบค่าแก๊ส', ops: ['-', '*'] }),
  () => ({ question: 'แม่ค้าขายผลไม้ มีส้ม 100 กิโลกรัม เน่าเสียไป 10 กิโลกรัม ที่เหลือขายกิโลกรัมละ 35 บาท จะได้เงินกี่บาท?', answer: 3150, symbolic: '(100 - 10) × 35 = ?', hint: 'ลบที่เน่าเสียก่อนแล้วคูณราคา', ops: ['-', '*'] }),
  () => ({ question: 'นักมายากล มีไพ่ 5 สำรับ สำรับละ 52 ใบ ทำหายไป 12 ใบ เหลือไพ่ทั้งหมดกี่ใบ?', answer: 248, symbolic: '(5 × 52) - 12 = ?', hint: 'คูณจำนวนไพ่ทั้งหมดก่อนแล้วลบที่หาย', ops: ['-', '*'] }),
  () => ({ question: 'ยามรักษาความปลอดภัย เดินตรวจตราอาคาร 8 ชั้น ชั้นละ 15 นาที และพักเบรก 1 ชั่วโมง (60 นาที) รวมเวลาเข้าเวรทั้งหมดกี่นาที?', answer: 180, symbolic: '(8 × 15) + 60 = ?', hint: 'คูณเวลาตรวจตราแล้วบวกเวลาพัก', ops: ['+', '*'] }),
  () => ({ question: 'คนกวาดถนน กวาดใบไม้ได้ 15 ถุง ถุงละ 2 กิโลกรัม นำไปทำปุ๋ยหมักขายกิโลกรัมละ 5 บาท จะได้เงินกี่บาท?', answer: 150, symbolic: '15 × 2 × 5 = ?', hint: 'คูณจำนวนถุง × น้ำหนักต่อถุง × ราคาต่อกิโล', ops: ['*'] }),
  () => ({ question: 'พนักงานดับเพลิง เตรียมสายฉีดน้ำยาว 20 เมตร จำนวน 15 เส้น แต่นำมาต่อกันแล้วสั้นไป 10 เมตร ความยาวรวมที่ได้จริงคือกี่เมตร?', answer: 290, symbolic: '(20 × 15) - 10 = ?', hint: 'คูณความยาวทั้งหมดก่อนแล้วลบส่วนที่สั้นไป', ops: ['-', '*'] }),
  () => ({ question: 'ชาวสวนยาง กรีดยางได้วันละ 50 กิโลกรัม ขายกิโลกรัมละ 20 บาท ทำงาน 7 วัน จะมีรายได้กี่บาท?', answer: 7000, symbolic: '50 × 20 × 7 = ?', hint: 'คูณจำนวนยาง × ราคา × จำนวนวัน', ops: ['*'] }),

  // ─── สัตว์/นิทาน ───
  () => ({ question: 'แม่ไก่ ออกไข่วันละ 3 ฟอง เป็นเวลา 14 วัน นำไปฟักเป็นลูกเจี๊ยบ 10 ตัว เหลือไข่ไก่กี่ฟอง?', answer: 32, symbolic: '(3 × 14) - 10 = ?', hint: 'คูณจำนวนไข่ต่อวัน × จำนวนวัน แล้วลบที่ฟัก', ops: ['-', '*'] }),
  () => ({ question: 'ผึ้งงาน บินไปเก็บน้ำหวานจากดอกไม้ 50 ดอก ดอกละ 2 หยด นำกลับรังแล้วทำหกไป 10 หยด เหลือน้ำหวานกี่หยด?', answer: 90, symbolic: '(50 × 2) - 10 = ?', hint: 'คูณจำนวนน้ำหวานทั้งหมดแล้วลบที่หก', ops: ['-', '*'] }),
  () => ({ question: 'มดแดง ช่วยกันขนน้ำตาลก้อน 5 ก้อน ก้อนหนึ่งหนัก 10 กรัม มีมดมาช่วยขนเพิ่มอีกทำให้ขนได้เพิ่มอีก 30 กรัม รวมขนน้ำตาลได้กี่กรัม?', answer: 80, symbolic: '(5 × 10) + 30 = ?', hint: 'คูณจำนวนก้อน × น้ำหนักก่อนแล้วบวกที่ได้เพิ่ม', ops: ['+', '*'] }),
  () => ({ question: 'ลูกหมูสามตัว ช่วยกันสร้างบ้านอิฐ ใช้ก้อนอิฐ 500 ก้อน หมูตัวพี่ทำแตกไป 25 ก้อน หมูตัวน้องซื้อมาเพิ่ม 50 ก้อน รวมมีอิฐสร้างบ้านกี่ก้อน?', answer: 525, symbolic: '500 - 25 + 50 = ?', hint: 'ลบที่แตกออกก่อนแล้วบวกที่ซื้อเพิ่ม', ops: ['+', '-'] }),
  () => ({ question: 'เจ้าหญิง มีชุดราตรี 12 ชุด สั่งตัดเพิ่มอีก 3 ชุด ราคาชุดละ 2,000 บาท เจ้าหญิงต้องจ่ายเงินค่าชุดใหม่กี่บาท?', answer: 6000, symbolic: '3 × 2,000 = ?', hint: 'คูณจำนวนชุดใหม่ × ราคา', ops: ['*'] }),
  () => ({ question: 'มังกรพ่นไฟ เผาป่าปีศาจไป 100 ไร่ วันต่อมาเผาได้น้อยกว่าเดิม 20 ไร่ รวมสองวันมังกรเผาป่าไปกี่ไร่?', answer: 180, symbolic: '100 + (100 - 20) = ?', symbolicAlt: '100 + 80 = ?', hint: 'วันที่สอง = 100-20=80 แล้วรวมทั้งสองวัน', ops: ['+', '-'] }),
  () => ({ question: 'มนุษย์ต่างดาว มีตา 3 ดวง จำนวน 20 ตัว เดินทางมาเจอกับมนุษย์ต่างดาวที่มีตา 1 ดวง จำนวน 15 ตัว รวมมีดวงตาทั้งหมดกี่ดวง?', answer: 75, symbolic: '(3 × 20) + (1 × 15) = ?', hint: 'คูณแต่ละกลุ่มแล้วรวมกัน', ops: ['+', '*'] }),
  () => ({ question: 'นางเงือก เก็บไข่มุกได้ 45 เม็ด นำไปร้อยสร้อยคอเส้นละ 9 เม็ด จะได้สร้อยคอกี่เส้น?', answer: 5, symbolic: '45 ÷ 9 = ?', hint: 'หารจำนวนไข่มุกด้วยจำนวนต่อเส้น', ops: ['/'] }),
  () => ({ question: 'ยักษ์ใหญ่ กินไก่ย่างมื้อละ 15 ตัว กินวันละ 3 มื้อ เป็นเวลา 2 วัน ยักษ์กินไก่ไปทั้งหมดกี่ตัว?', answer: 90, symbolic: '15 × 3 × 2 = ?', hint: 'คูณจำนวนต่อมื้อ × จำนวนมื้อ × จำนวนวัน', ops: ['*'] }),
  () => ({ question: 'นกเพนกวิน เดินเตาะแตะระยะทาง 5 กิโลเมตร พักเหนื่อยทุกๆ 1 กิโลเมตร ครั้งละ 10 นาที รวมเวลาพักทั้งหมดกี่นาที?', answer: 40, symbolic: '4 × 10 = ?', hint: 'พัก 4 ครั้ง (ไม่พักจุดเริ่มต้นและจุดสิ้นสุด) คูณเวลาพัก', ops: ['*'] }),
  () => ({ question: 'แมงมุม ชักใยทำรัง 4 มุม มุมละ 20 เส้น แต่โดนลมพัดขาดไป 12 เส้น เหลือใยแมงมุมกี่เส้น?', answer: 68, symbolic: '(4 × 20) - 12 = ?', hint: 'คูณจำนวนใยทั้งหมดแล้วลบที่ขาด', ops: ['-', '*'] }),
  () => ({ question: 'ปลาโลมา กระโดดโชว์รอบละ 15 ครั้ง แสดงวันละ 4 รอบ แต่รอบสุดท้ายเหนื่อยกระโดดได้แค่ 10 ครั้ง วันนี้ปลาโลมากระโดดกี่ครั้ง?', answer: 55, symbolic: '(3 × 15) + 10 = ?', hint: '3 รอบแรก × 15 แล้วบวกรอบสุดท้าย 10', ops: ['+', '*'] }),
  () => ({ question: 'จิงโจ้ กระโดดไกลครั้งละ 3 เมตร กระโดด 50 ครั้ง ได้ระยะทางกี่เมตร?', answer: 150, symbolic: '3 × 50 = ?', hint: 'คูณระยะต่อครั้ง × จำนวนครั้ง', ops: ['*'] }),
  () => ({ question: 'หมีแพนด้า กินไผ่วันละ 12 กิโลกรัม ใน 1 เดือน (30 วัน) สวนสัตว์ต้องเตรียมไผ่กี่กิโลกรัม?', answer: 360, symbolic: '12 × 30 = ?', hint: 'คูณจำนวนไผ่ต่อวัน × จำนวนวัน', ops: ['*'] }),
  () => ({ question: 'ช้างน้อย พ่นน้ำใส่เพื่อน 5 ครั้ง ครั้งละ 2 ลิตร และทำน้ำหกอีก 3 ลิตร รวมช้างน้อยใช้น้ำไปกี่ลิตร?', answer: 13, symbolic: '(5 × 2) + 3 = ?', hint: 'คูณน้ำที่พ่นแล้วบวกที่หก', ops: ['+', '*'] }),
  () => ({ question: 'นกฮูก ตื่นตอนกลางคืน 10 ชั่วโมง ใน 1 สัปดาห์ นกฮูกตื่นรวมกี่ชั่วโมง?', answer: 70, symbolic: '10 × 7 = ?', hint: 'คูณเวลาตื่นต่อวัน × 7 วัน', ops: ['*'] }),
  () => ({ question: 'ม้าโพนี่ มีกิ๊บติดผม 20 อัน เพื่อนให้มาอีก 5 อัน ทำหายไป 2 อัน เหลือกิ๊บติดผมกี่อัน?', answer: 23, symbolic: '20 + 5 - 2 = ?', hint: 'บวกที่ได้รับแล้วลบที่หาย', ops: ['+', '-'] }),

  // ─── โรงเรียน ───
  () => ({ question: 'คุณครู ตรวจการบ้านนักเรียน 30 เล่ม เล่มละ 5 นาที พักเบรก 20 นาที รวมใช้เวลาทั้งหมดกี่นาที?', answer: 170, symbolic: '(30 × 5) + 20 = ?', hint: 'คูณจำนวนเล่ม × เวลาต่อเล่ม แล้วบวกเวลาพัก', ops: ['+', '*'] }),
  () => ({ question: 'นักเรียน มีเงินค่าขนม 100 บาท ซื้อข้าว 30 บาท ซื้อน้ำ 10 บาท และหยอดกระปุก 20 บาท เหลือเงินกี่บาท?', answer: 40, symbolic: '100 - 30 - 10 - 20 = ?', hint: 'ลบค่าใช้จ่ายทั้งหมดออกจากเงินที่มี', ops: ['-'] }),
  () => ({ question: 'หัวหน้าห้อง รวบรวมเงินทำบุญจากเพื่อน 40 คน คนละ 10 บาท และคุณครูสมทบอีก 500 บาท รวมเป็นเงินกี่บาท?', answer: 900, symbolic: '(40 × 10) + 500 = ?', hint: 'คูณจำนวนคน × เงินต่อคนแล้วบวกที่ครูสมทบ', ops: ['+', '*'] }),
  () => ({ question: 'แม่ครัวโรงเรียน ทอดไข่เจียว 200 ฟอง ใช้ไข่ฟองละ 4 บาท และค่าน้ำมัน 100 บาท รวมต้นทุนกี่บาท?', answer: 900, symbolic: '(200 × 4) + 100 = ?', hint: 'คูณค่าไข่ทั้งหมดแล้วบวกค่าน้ำมัน', ops: ['+', '*'] }),
  () => ({ question: 'ชมรมดนตรี มีสมาชิกรุ่นเก่า 15 คน รับสมัครรุ่นใหม่ได้ 4 กลุ่ม กลุ่มละ 5 คน รวมมีสมาชิกทั้งหมดกี่คน?', answer: 35, symbolic: '15 + (4 × 5) = ?', hint: 'คูณจำนวนกลุ่ม × คนต่อกลุ่มแล้วบวกรุ่นเก่า', ops: ['+', '*'] }),
  () => ({ question: 'บรรณารักษ์น้อย ซ่อมหนังสือ 10 เล่ม ใช้เทปกาวเล่มละ 20 เซนติเมตร ต้องใช้เทปกาวทั้งหมดกี่เซนติเมตร?', answer: 200, symbolic: '10 × 20 = ?', hint: 'คูณจำนวนเล่ม × เทปกาวต่อเล่ม', ops: ['*'] }),
  () => ({ question: 'ลูกเสือ เดินทางไกล 8 กิโลเมตร (8,000 เมตร) เดินไปแล้ว 3,500 เมตร เหลือระยะทางอีกกี่เมตร?', answer: 4500, symbolic: '8,000 - 3,500 = ?', hint: 'ลบระยะที่เดินแล้วออกจากระยะทางทั้งหมด', ops: ['-'] }),
  () => ({ question: 'เนตรนารี ผูกเงื่อนพิรอด 20 เส้น ใช้เชือกเส้นละ 50 เซนติเมตร รวมใช้เชือกทั้งหมดกี่เซนติเมตร?', answer: 1000, symbolic: '20 × 50 = ?', hint: 'คูณจำนวนเส้น × ความยาวต่อเส้น', ops: ['*'] }),
  () => ({ question: 'นักกีฬาโรงเรียน ซ้อมวิ่งรอบสนาม 400 เมตร จำนวน 5 รอบ วิ่งรวมระยะทางกี่เมตร?', answer: 2000, symbolic: '400 × 5 = ?', hint: 'คูณระยะทางต่อรอบ × จำนวนรอบ', ops: ['*'] }),
  () => ({ question: 'สหกรณ์โรงเรียน ขายสมุดโหลละ 120 บาท (12 เล่ม) ถ้านักเรียนซื้อ 3 เล่ม ต้องจ่ายเงินกี่บาท?', answer: 30, symbolic: '120 ÷ 12 × 3 = ?', hint: 'หาราคาต่อเล่มก่อน (หาร) แล้วคูณจำนวนที่ซื้อ', ops: ['*', '/'] }),
  () => ({ question: 'เวรประจำวัน ช่วยกันยกเก้าอี้ 40 ตัว จัดเป็นแถว แถวละ 8 ตัว จะจัดได้กี่แถว?', answer: 5, symbolic: '40 ÷ 8 = ?', hint: 'หารจำนวนเก้าอี้ด้วยจำนวนต่อแถว', ops: ['/'] }),
  () => ({ question: 'ภารโรง มีไม้กวาด 12 อัน ซื้อมาเพิ่มอีก 24 อัน นำไปแจกห้องเรียนห้องละ 3 อัน จะแจกได้กี่ห้อง?', answer: 12, symbolic: '(12 + 24) ÷ 3 = ?', hint: 'รวมจำนวนไม้กวาดทั้งหมดแล้วหาร', ops: ['+', '/'] }),

  // ─── ครอบครัว ───
  () => ({ question: 'เด็กชายก้อง สะสมแสตมป์ได้ 500 ดวง น้องขอไป 50 ดวง พ่อให้เพิ่มมาอีก 100 ดวง ก้องมีแสตมป์กี่ดวง?', answer: 550, symbolic: '500 - 50 + 100 = ?', hint: 'ลบที่ให้น้องแล้วบวกที่พ่อให้', ops: ['+', '-'] }),
  () => ({ question: 'เด็กหญิงฟ้า ร้อยลูกปัดกำไลข้อมือ 5 เส้น เส้นละ 20 เม็ด ทำหล่นหายไป 15 เม็ด เหลือลูกปัดที่ร้อยแล้วกี่เม็ด?', answer: 85, symbolic: '(5 × 20) - 15 = ?', hint: 'คูณจำนวนลูกปัดทั้งหมดแล้วลบที่หาย', ops: ['-', '*'] }),
  () => ({ question: 'คุณยาย ทำขนมใส่ไส้ 50 ห่อ หลานกินไป 4 ห่อ ที่เหลือขายห่อละ 5 บาท จะได้เงินกี่บาท?', answer: 230, symbolic: '(50 - 4) × 5 = ?', hint: 'ลบที่หลานกินก่อนแล้วคูณราคาขาย', ops: ['-', '*'] }),
  () => ({ question: 'คุณปู่ ปลูกต้นมะม่วง 4 แถว แถวละ 5 ต้น ตายไป 2 ต้น เหลือต้นมะม่วงที่รอดกี่ต้น?', answer: 18, symbolic: '(4 × 5) - 2 = ?', hint: 'คูณจำนวนต้นทั้งหมดแล้วลบที่ตาย', ops: ['-', '*'] }),
  () => ({ question: 'น้องบี แปรงฟันวันละ 2 ครั้ง ครั้งละ 3 นาที ใน 1 สัปดาห์ น้องบีใช้เวลาแปรงฟันกี่นาที?', answer: 42, symbolic: '2 × 3 × 7 = ?', hint: 'คูณครั้งต่อวัน × นาทีต่อครั้ง × 7 วัน', ops: ['*'] }),
  () => ({ question: 'พี่เอก ขี่จักรยานไปตลาด 2 กิโลเมตร (2,000 เมตร) ขากลับแวะร้านค้า ขี่อ้อมไปอีก 500 เมตร รวมระยะทางไปกลับกี่เมตร?', answer: 4500, symbolic: '2,000 + 2,000 + 500 = ?', hint: 'ขาไป + ขากลับ + ระยะอ้อม', ops: ['+'] }),
  () => ({ question: 'คุณน้า ซื้อผ้ามา 10 เมตร ตัดเสื้อไป 4 เมตร ตัดกางเกงไป 3 เมตร เหลือผ้ากี่เมตร?', answer: 3, symbolic: '10 - 4 - 3 = ?', hint: 'ลบผ้าที่ใช้ทั้งสองชิ้นออก', ops: ['-'] }),
  () => ({ question: 'ลุงยาม เปิดประตูโรงเรียนตอน 6 โมงเช้า ปิดตอน 6 โมงเย็น ลุงยามเปิดประตูทิ้งไว้นานกี่ชั่วโมง?', answer: 12, symbolic: '18 - 6 = ?', hint: 'ลบเวลาเปิดออกจากเวลาปิด (06:00-18:00)', ops: ['-'] }),

  // ─── อาหาร/ร้านค้า ───
  () => ({ question: 'คนทำขนมปัง อบขนมปังถาดละ 12 ชิ้น อบ 5 ถาด ไหม้ไป 6 ชิ้น เหลือขนมปังที่ขายได้กี่ชิ้น?', answer: 54, symbolic: '(12 × 5) - 6 = ?', hint: 'คูณจำนวนขนมปังทั้งหมดแล้วลบที่ไหม้', ops: ['-', '*'] }),
  () => ({ question: 'เด็กเสิร์ฟ ยกจานอาหาร 3 โต๊ะ โต๊ะละ 4 จาน ทำแตกไป 1 จาน เหลือจานที่ต้องล้างกี่จาน?', answer: 11, symbolic: '(3 × 4) - 1 = ?', hint: 'คูณจำนวนจานทั้งหมดแล้วลบที่แตก', ops: ['-', '*'] }),
  () => ({ question: 'บาริสต้า ชงกาแฟแก้วละ 50 บาท ขายได้ 100 แก้ว นำเงินไปซื้อเมล็ดกาแฟ 2,000 บาท เหลือกำไรกี่บาท?', answer: 3000, symbolic: '(50 × 100) - 2,000 = ?', hint: 'คูณรายได้ทั้งหมดแล้วลบต้นทุน', ops: ['-', '*'] }),
  () => ({ question: 'คนขายไอศกรีม มีไอศกรีม 5 รส รสละ 2 ถัง ขายหมดไป 7 ถัง เหลือไอศกรีมกี่ถัง?', answer: 3, symbolic: '(5 × 2) - 7 = ?', hint: 'คูณจำนวนทั้งหมดแล้วลบที่ขาย', ops: ['-', '*'] }),
  () => ({ question: 'แม่บ้าน หุงข้าวสวย 3 หม้อ หม้อละ 10 จาน ตักแจกคนงานไป 25 จาน เหลือข้าวกี่จาน?', answer: 5, symbolic: '(3 × 10) - 25 = ?', hint: 'คูณจำนวนข้าวทั้งหมดแล้วลบที่แจก', ops: ['-', '*'] }),
  () => ({ question: 'พ่อครัว หั่นเนื้อหมูชิ้นละ 200 กรัม จำนวน 5 ชิ้น นำไปผัดกะเพรา 300 กรัม เหลือเนื้อหมูกี่กรัม?', answer: 700, symbolic: '(200 × 5) - 300 = ?', hint: 'คูณเนื้อทั้งหมดแล้วลบที่ใช้ผัด', ops: ['-', '*'] }),
  () => ({ question: 'คนขายลูกชิ้น ปิ้งลูกชิ้นไม้ละ 10 บาท ลูกค้าสั่ง 5 ไม้ ให้แบงก์ 100 บาท ต้องทอนเงินกี่บาท?', answer: 50, symbolic: '100 - (5 × 10) = ?', hint: 'คูณค่าลูกชิ้นทั้งหมดแล้วลบจากเงินที่ให้', ops: ['-', '*'] }),
  () => ({ question: 'นักชิมอาหาร ชิมเค้ก 4 ชิ้น ชิ้นละ 250 แคลอรี่ แล้วไปวิ่งออกกำลังกายเบิร์นออก 500 แคลอรี่ เหลือพลังงานสะสมกี่แคลอรี่?', answer: 500, symbolic: '(4 × 250) - 500 = ?', hint: 'คูณแคลอรี่ทั้งหมดแล้วลบที่เบิร์น', ops: ['-', '*'] }),
  () => ({ question: 'คนขายน้ำปั่น ปั่นน้ำแตงโม 20 แก้ว ใช้น้ำแข็งแก้วละ 5 ก้อน ต้องเตรียมน้ำแข็งทั้งหมดกี่ก้อน?', answer: 100, symbolic: '20 × 5 = ?', hint: 'คูณจำนวนแก้ว × น้ำแข็งต่อแก้ว', ops: ['*'] }),
  () => ({ question: 'พนักงานส่งพิซซ่า มีพิซซ่า 10 ถาด ถาดละ 8 ชิ้น ส่งให้ลูกค้า 5 บ้าน บ้านละ 1 ถาด เหลือพิซซ่ากี่ชิ้น?', answer: 40, symbolic: '(10 - 5) × 8 = ?', hint: 'ลบถาดที่ส่งแล้วคูณชิ้นต่อถาด', ops: ['-', '*'] }),

  // ─── ท่องเที่ยว/ยานพาหนะ ───
  () => ({ question: 'กระเป๋ารถเมล์ เก็บค่าโดยสาร 15 บาท จากผู้โดยสาร 20 คน และ 10 บาท จากเด็ก 5 คน รวมเก็บเงินได้กี่บาท?', answer: 350, symbolic: '(15 × 20) + (10 × 5) = ?', hint: 'คูณแต่ละกลุ่มแล้วบวกรวม', ops: ['+', '*'] }),
  () => ({ question: 'กัปตันเครื่องบิน บินจากกรุงเทพฯ ไปเชียงใหม่ 700 กิโลเมตร บินไป-กลับ 2 รอบ รวมระยะทางกี่กิโลเมตร?', answer: 2800, symbolic: '700 × 2 × 2 = ?', hint: 'คูณระยะทาง × ไป-กลับ × จำนวนรอบ', ops: ['*'] }),
  () => ({ question: 'นายสถานีรถไฟ ขายตั๋วรถไฟใบละ 50 บาท ได้ 100 ใบ มีคนมาคืนตั๋ว 10 ใบ หักเงินคืนเต็มจำนวน เหลือรายได้จากการขายตั๋วกี่บาท?', answer: 4500, symbolic: '(100 - 10) × 50 = ?', hint: 'ลบจำนวนที่คืนก่อนแล้วคูณราคา', ops: ['-', '*'] }),
  () => ({ question: 'คนขับวินมอเตอร์ไซค์ ขับรถส่งคน 8 เที่ยว เที่ยวละ 20 บาท นำเงินไปเติมน้ำมัน 60 บาท เหลือเงินกี่บาท?', answer: 100, symbolic: '(8 × 20) - 60 = ?', hint: 'คูณรายได้ก่อนแล้วลบค่าน้ำมัน', ops: ['-', '*'] }),
  () => ({ question: 'นักท่องเที่ยว มีเงิน 5,000 บาท จ่ายค่าที่พัก 1,500 บาท ค่าอาหาร 1,000 บาท ค่าของฝาก 500 บาท เหลือเงินกลับบ้านกี่บาท?', answer: 2000, symbolic: '5,000 - 1,500 - 1,000 - 500 = ?', hint: 'ลบค่าใช้จ่ายทั้งหมดออกจากเงินที่มี', ops: ['-'] }),
  () => ({ question: 'คนพายเรือ พายเรือข้ามฟากเที่ยวละ 10 นาที พายไป-กลับ 5 รอบ รวมใช้เวลาพายเรือกี่นาที?', answer: 100, symbolic: '10 × 2 × 5 = ?', hint: 'คูณเวลาต่อเที่ยว × ไป-กลับ × จำนวนรอบ', ops: ['*'] }),
  () => ({ question: 'แอร์โฮสเตส เสิร์ฟน้ำผู้โดยสารแถวละ 6 แก้ว จำนวน 10 แถว ทำหกไป 2 แก้ว เสิร์ฟได้จริงกี่แก้ว?', answer: 58, symbolic: '(6 × 10) - 2 = ?', hint: 'คูณจำนวนแก้วทั้งหมดแล้วลบที่หก', ops: ['-', '*'] }),
  () => ({ question: 'คนขับรถบรรทุก บรรทุกทรายมา 10 ตัน เทลงบ่อ 3 ตัน แล้วไปรับหินเพิ่มอีก 5 ตัน ตอนนี้รถหนักกี่ตัน?', answer: 12, symbolic: '10 - 3 + 5 = ?', hint: 'ลบที่เทออกแล้วบวกที่รับเพิ่ม', ops: ['+', '-'] }),
  () => ({ question: 'นายตรวจบัตร ตรวจบัตรเข้าชมสวนสนุกราคา 100 บาท จำนวน 50 คน และบัตรเด็กราคา 50 บาท จำนวน 20 คน รวมเป็นเงินค่าเข้าชมกี่บาท?', answer: 6000, symbolic: '(100 × 50) + (50 × 20) = ?', hint: 'คูณแต่ละกลุ่มแล้วบวกรวม', ops: ['+', '*'] }),
  () => ({ question: 'ไกด์นำเที่ยว พาลูกทัวร์ 40 คน ขึ้นรถบัส 2 คัน คันละเท่าๆ กัน รถคันแรกมีที่นั่งว่าง 5 ที่ รถคันนั้นมีกี่ที่นั่ง?', answer: 25, symbolic: '(40 ÷ 2) + 5 = ?', hint: 'หารจำนวนคนแล้วบวกที่ว่าง', ops: ['+', '/'] }),

  // ─── เกษตรกร ───
  () => ({ question: 'ชาวนาเกลือ กองเกลือไว้ 10 กอง กองละ 50 กิโลกรัม ขายไป 300 กิโลกรัม เหลือเกลือกี่กิโลกรัม?', answer: 200, symbolic: '(10 × 50) - 300 = ?', hint: 'คูณเกลือทั้งหมดแล้วลบที่ขาย', ops: ['-', '*'] }),
  () => ({ question: 'คนเลี้ยงแกะ มีแกะ 40 ตัว ตัดขนแกะได้ตัวละ 2 กิโลกรัม นำขนไปขายกิโลกรัมละ 100 บาท ได้เงินทั้งหมดกี่บาท?', answer: 8000, symbolic: '40 × 2 × 100 = ?', hint: 'คูณจำนวนแกะ × ขนต่อตัว × ราคาต่อกิโล', ops: ['*'] }),
  () => ({ question: 'ชาวไร่อ้อย ตัดอ้อยได้ 500 มัด ส่งโรงงาน 400 มัด ที่เหลือแบ่งให้คนงาน 5 คน คนละเท่าๆ กัน คนงานได้อ้อยคนละกี่มัด?', answer: 20, symbolic: '(500 - 400) ÷ 5 = ?', hint: 'ลบที่ส่งโรงงานก่อนแล้วหาร', ops: ['-', '/'] }),
  () => ({ question: 'คนปลูกผัก ปลูกคะน้า 3 แปลง แปลงละ 20 ต้น หนอนกินใบไป 5 ต้น เหลือคะน้าที่สมบูรณ์กี่ต้น?', answer: 55, symbolic: '(3 × 20) - 5 = ?', hint: 'คูณจำนวนคะน้าทั้งหมดแล้วลบที่หนอนกิน', ops: ['-', '*'] }),
  () => ({ question: 'ชาวประมงเรือเล็ก วางลอบดักปู 10 อัน กู้อันแรกได้ 5 ตัว อันที่สองได้ 3 ตัว อันอื่นๆ ไม่ได้เลย รวมได้ปูกี่ตัว?', answer: 8, symbolic: '5 + 3 = ?', hint: 'บวกจำนวนปูที่จับได้ทั้งหมด', ops: ['+'] }),
  () => ({ question: 'คนเก็บของป่า เก็บเห็ดโคนได้ 2,000 กรัม แบ่งใส่ถุง ถุงละ 200 กรัม ได้กี่ถุง?', answer: 10, symbolic: '2,000 ÷ 200 = ?', hint: 'หารน้ำหนักทั้งหมดด้วยน้ำหนักต่อถุง', ops: ['/'] }),
  () => ({ question: 'เจ้าหน้าที่ป่าไม้ ปลูกป่าชายเลน 500 ต้น ตายไป 50 ต้น ปีต่อมาปลูกซ่อมอีก 100 ต้น รวมมีต้นไม้รอดกี่ต้น?', answer: 550, symbolic: '500 - 50 + 100 = ?', hint: 'ลบที่ตายแล้วบวกที่ปลูกเพิ่ม', ops: ['+', '-'] }),
  () => ({ question: 'คนเลี้ยงปลา ให้อาหารปลาวันละ 2 กระสอบ กระสอบละ 20 กิโลกรัม ใน 1 เดือน (30 วัน) ใช้อาหารปลากี่กิโลกรัม?', answer: 1200, symbolic: '2 × 20 × 30 = ?', hint: 'คูณจำนวนกระสอบ × น้ำหนักต่อกระสอบ × จำนวนวัน', ops: ['*'] }),
  () => ({ question: 'ชาวสวนทุเรียน ขายทุเรียนลูกละ 500 บาท จำนวน 10 ลูก นำเงินไปซื้อปุ๋ย 2,000 บาท เหลือเงินกี่บาท?', answer: 3000, symbolic: '(500 × 10) - 2,000 = ?', hint: 'คูณรายได้ก่อนแล้วลบค่าปุ๋ย', ops: ['-', '*'] }),
  () => ({ question: 'คนทำนา มีที่นา 20 ไร่ เกี่ยวข้าวได้ไร่ละ 500 กิโลกรัม รวมได้ข้าวทั้งหมดกี่กิโลกรัม?', answer: 10000, symbolic: '20 × 500 = ?', hint: 'คูณจำนวนไร่ × ผลผลิตต่อไร่', ops: ['*'] }),

  // ─── งานอดิเรก ───
  () => ({ question: 'นักสะสมเหรียญ มีเหรียญเก่า 200 เหรียญ ซื้อมาเพิ่มอีก 50 เหรียญ แบ่งใส่สมุดเล่มละ 50 เหรียญ ต้องใช้สมุดกี่เล่ม?', answer: 5, symbolic: '(200 + 50) ÷ 50 = ?', hint: 'รวมจำนวนเหรียญก่อนแล้วหาร', ops: ['+', '/'] }),
  () => ({ question: 'เกมเมอร์ เล่นเกมชนะ 5 ตา ตาละ 100 คะแนน แพ้ 2 ตา โดนหักตาละ 50 คะแนน รวมคะแนนที่ได้เท่าไหร่?', answer: 400, symbolic: '(5 × 100) - (2 × 50) = ?', hint: 'คูณคะแนนชนะแล้วลบคะแนนที่ถูกหัก', ops: ['-', '*'] }),
  () => ({ question: 'นักดูนก ส่องกล้องเจอนกกระจิบ 15 ตัว นกเขา 8 ตัว นกพิราบมากกว่านกกระจิบ 5 ตัว รวมเจอนกทั้งหมดกี่ตัว?', answer: 43, symbolic: '15 + 8 + (15 + 5) = ?', hint: 'หาจำนวนนกพิราบก่อน (15+5=20) แล้วรวมทั้งหมด', ops: ['+'] }),
  () => ({ question: 'คนต่อเลโก้ มีตัวต่อ 1,000 ชิ้น ต่อเป็นปราสาทใช้ 600 ชิ้น ต่อเป็นรถใช้ 150 ชิ้น เหลือตัวต่อกี่ชิ้น?', answer: 250, symbolic: '1,000 - 600 - 150 = ?', hint: 'ลบที่ใช้ทั้งสองชิ้นออก', ops: ['-'] }),
  () => ({ question: 'นักปั่นจักรยาน ปั่นวันละ 20 กิโลเมตร เป็นเวลา 6 วัน วันอาทิตย์ปั่นเพิ่มอีก 30 กิโลเมตร รวม 1 สัปดาห์ปั่นได้กี่กิโลเมตร?', answer: 150, symbolic: '(20 × 6) + 30 = ?', hint: 'คูณวันปกติแล้วบวกวันอาทิตย์', ops: ['+', '*'] }),
  () => ({ question: 'นักเต้น ซ้อมเต้นเพลงละ 4 นาที ซ้อม 10 รอบ พัก 15 นาที รวมใช้เวลาซ้อมกี่นาที?', answer: 55, symbolic: '(4 × 10) + 15 = ?', hint: 'คูณเวลาซ้อมทั้งหมดแล้วบวกเวลาพัก', ops: ['+', '*'] }),
  () => ({ question: 'คนจัดดอกไม้ ซื้อกุหลาบดอกละ 10 บาท จำนวน 50 ดอก นำมาจัดใส่แจกัน 5 ใบ ใบละเท่าๆ กัน แต่ละแจกันมีมูลค่าดอกไม้กี่บาท?', answer: 100, symbolic: '(10 × 50) ÷ 5 = ?', hint: 'คูณค่าดอกไม้ทั้งหมดแล้วหาร', ops: ['*', '/'] }),

  // ─── ผจญภัย ───
  () => ({ question: 'นักปีนเขา ปีนหน้าผาสูง 500 เมตร ปีนได้ชั่วโมงละ 100 เมตร พัก 1 ชั่วโมง รวมใช้เวลาทั้งหมดกี่ชั่วโมง?', answer: 6, symbolic: '(500 ÷ 100) + 1 = ?', hint: 'หารระยะทางด้วยความเร็วแล้วบวกเวลาพัก', ops: ['+', '/'] }),
  () => ({ question: 'นักดำน้ำ ดำลงไปลึก 20 เมตร เจอฝูงปลา 3 ฝูง ฝูงละ 100 ตัว รวมเจอปลาทั้งหมดกี่ตัว?', answer: 300, symbolic: '3 × 100 = ?', hint: 'คูณจำนวนฝูง × จำนวนต่อฝูง', ops: ['*'] }),

  // ─── เพิ่มเติมเฉพาะ +, - ง่ายๆ ───
  () => ({ question: 'ชาวประมง หาปลาทูได้ 350 ตัว แบ่งใส่เข่ง เข่งละ 50 ตัว ได้กี่เข่ง?', answer: 7, symbolic: '350 ÷ 50 = ?', hint: 'หารจำนวนปลาด้วยจำนวนต่อเข่ง', ops: ['/'] }),
  () => ({ question: 'ช่างตัดผม ตัดผมให้ลูกค้าวันละ 12 คน คิดราคาหัวละ 150 บาท ทำงาน 5 วัน จะได้เงินรวมทั้งหมดกี่บาท?', answer: 9000, symbolic: '12 × 150 × 5 = ?', hint: 'คูณจำนวนลูกค้า × ราคา × จำนวนวัน', ops: ['*'] }),
  () => ({ question: 'เชฟกระทะเหล็ก ต้องทำอาหาร 80 จาน จานหนึ่งใช้วัตถุดิบ 3 ชนิด แต่ละชนิดราคา 5 บาท รวมต้นทุนค่าวัตถุดิบทั้งหมดกี่บาท?', answer: 1200, symbolic: '80 × 3 × 5 = ?', hint: 'คูณจำนวนจาน × วัตถุดิบต่อจาน × ราคาต่อชนิด', ops: ['*'] }),
  () => ({ question: 'นักบินอวกาศ นำอาหารขึ้นยานไป 500 แพ็ค ทานวันละ 3 แพ็ค เป็นเวลา 90 วัน จะเหลืออาหารกี่แพ็ค?', answer: 230, symbolic: '500 - (3 × 90) = ?', hint: 'คูณจำนวนที่ทานต่อวันกับจำนวนวัน แล้วลบจากทั้งหมด', ops: ['-', '*'] }),
  () => ({ question: 'กระรอกน้อย เก็บลูกโอ๊คได้ 120 ลูก แบ่งให้เพื่อน 4 ตัว ตัวละ 20 ลูก เพื่อนคืนมาให้ 5 ลูก กระรอกน้อยเหลือลูกโอ๊คกี่ลูก?', answer: 45, symbolic: '120 - (4 × 20) + 5 = ?', hint: 'ลบที่แบ่งไปก่อน (4×20=80) แล้วบวกที่ได้คืน', ops: ['+', '-', '*'] }),
  () => ({ question: 'สิงโตเจ้าป่า ล่าเหยื่อได้ 3 ตัว แบ่งให้ลูกสิงโต 5 ตัว ตัวละ 2 กิโลกรัม เหยื่อแต่ละตัวหนักกี่กิโลกรัม?', answer: 10, symbolic: '(5 × 2) ÷ 3 × 3 = 10', hint: 'เหยื่อรวม = ลูกสิงโต×กิโลต่อตัว ÷ จำนวนเหยื่อ (สมมติแบ่งหมดพอดี)', ops: ['*', '/'] }),
  // simple + or - only
  () => ({ question: 'นักวาดภาพ ระบายสีภาพ 5 ภาพ ใช้เวลาภาพละ 2 ชั่วโมง ถ้าเริ่มทำตอน 8.00 น. จะเสร็จกี่โมง?', answer: 18, symbolic: '8 + (5 × 2) = ?', hint: 'คูณเวลาที่ใช้ทั้งหมดแล้วบวกเวลาเริ่ม', ops: ['+', '*'] }),
];

// ============================================================
// 3-OP TEMPLATES (each has 3 operands, already included above as multi-step)
// These are templates with 3+ steps from the user data
// ============================================================

export const threeOpTemplates: MathTemplate[] = [
  () => ({ question: 'พนักงานไปรษณีย์ ต้องส่งจดหมาย 500 ซอง ส่งไปแล้วช่วงเช้า 120 ซอง ช่วงบ่ายส่งอีก 150 ซอง เหลือจดหมายที่ต้องส่งกี่ซอง?', answer: 230, symbolic: '500 - 120 - 150 = ?', symbolicAlt: '500 - (120 + 150) = ?', hint: 'ลบจำนวนที่ส่งทั้งช่วงเช้าและบ่ายออก', ops: ['-'] }),
  () => ({ question: 'วิศวกร ต้องการวางท่อน้ำยาว 1,000 เมตร วันแรกวางได้ 200 เมตร วันที่สองวางได้มากกว่าวันแรก 50 เมตร เหลือระยะทางที่ต้องวางท่ออีกกี่เมตร?', answer: 550, symbolic: '1,000 - 200 - (200 + 50) = ?', symbolicAlt: '1,000 - 200 - 250 = ?', hint: 'หาวันที่สอง (200+50) แล้วลบทั้งสองวันจาก 1,000', ops: ['+', '-'] }),
  () => ({ question: 'คุณหมอฟัน มีนัดขูดหินปูน 8 เคส เคสละ 30 นาที และถอนฟัน 2 เคส เคสละ 45 นาที รวมใช้เวลาทำฟันทั้งหมดกี่นาที?', answer: 330, symbolic: '(8 × 30) + (2 × 45) = ?', hint: 'คูณเวลาแต่ละประเภทแล้วบวกรวม', ops: ['+', '*'] }),
  () => ({ question: 'นักเรียน มีเงินค่าขนม 100 บาท ซื้อข้าว 30 บาท ซื้อน้ำ 10 บาท และหยอดกระปุก 20 บาท เหลือเงินกี่บาท?', answer: 40, symbolic: '100 - 30 - 10 - 20 = ?', symbolicAlt: '100 - (30 + 10 + 20) = ?', hint: 'ลบค่าใช้จ่ายทั้งหมดออก', ops: ['-'] }),
  () => ({ question: 'นักท่องเที่ยว มีเงิน 5,000 บาท จ่ายค่าที่พัก 1,500 บาท ค่าอาหาร 1,000 บาท ค่าของฝาก 500 บาท เหลือเงินกลับบ้านกี่บาท?', answer: 2000, symbolic: '5,000 - 1,500 - 1,000 - 500 = ?', symbolicAlt: '5,000 - (1,500 + 1,000 + 500) = ?', hint: 'ลบค่าใช้จ่ายทั้งหมดออก', ops: ['-'] }),
  () => ({ question: 'กระรอกน้อย เก็บลูกโอ๊คได้ 120 ลูก แบ่งให้เพื่อน 4 ตัว ตัวละ 20 ลูก เพื่อนคืนมาให้ 5 ลูก กระรอกน้อยเหลือลูกโอ๊คกี่ลูก?', answer: 45, symbolic: '120 - (4 × 20) + 5 = ?', symbolicAlt: '120 - 80 + 5 = ?', hint: 'ลบที่แบ่ง (4×20=80) แล้วบวกที่คืน', ops: ['+', '-', '*'] }),
  () => ({ question: 'ลูกหมูสามตัว ช่วยกันสร้างบ้านอิฐ ใช้ก้อนอิฐ 500 ก้อน หมูตัวพี่ทำแตกไป 25 ก้อน หมูตัวน้องซื้อมาเพิ่ม 50 ก้อน รวมมีอิฐสร้างบ้านกี่ก้อน?', answer: 525, symbolic: '500 - 25 + 50 = ?', hint: 'ลบที่แตกแล้วบวกที่ซื้อเพิ่ม', ops: ['+', '-'] }),
  () => ({ question: 'เด็กชายก้อง สะสมแสตมป์ได้ 500 ดวง น้องขอไป 50 ดวง พ่อให้เพิ่มมาอีก 100 ดวง ก้องมีแสตมป์กี่ดวง?', answer: 550, symbolic: '500 - 50 + 100 = ?', hint: 'ลบที่ให้น้องแล้วบวกที่พ่อให้', ops: ['+', '-'] }),
  () => ({ question: 'เจ้าหน้าที่ป่าไม้ ปลูกป่าชายเลน 500 ต้น ตายไป 50 ต้น ปีต่อมาปลูกซ่อมอีก 100 ต้น รวมมีต้นไม้รอดกี่ต้น?', answer: 550, symbolic: '500 - 50 + 100 = ?', hint: 'ลบที่ตายแล้วบวกที่ปลูกเพิ่ม', ops: ['+', '-'] }),
  () => ({ question: 'คนขับรถบรรทุก บรรทุกทรายมา 10 ตัน เทลงบ่อ 3 ตัน แล้วไปรับหินเพิ่มอีก 5 ตัน ตอนนี้รถหนักกี่ตัน?', answer: 12, symbolic: '10 - 3 + 5 = ?', hint: 'ลบที่เทออกแล้วบวกที่รับเพิ่ม', ops: ['+', '-'] }),
  () => ({ question: 'ม้าโพนี่ มีกิ๊บติดผม 20 อัน เพื่อนให้มาอีก 5 อัน ทำหายไป 2 อัน เหลือกิ๊บติดผมกี่อัน?', answer: 23, symbolic: '20 + 5 - 2 = ?', hint: 'บวกที่ได้รับแล้วลบที่หาย', ops: ['+', '-'] }),
  () => ({ question: 'คุณน้า ซื้อผ้ามา 10 เมตร ตัดเสื้อไป 4 เมตร ตัดกางเกงไป 3 เมตร เหลือผ้ากี่เมตร?', answer: 3, symbolic: '10 - 4 - 3 = ?', symbolicAlt: '10 - (4 + 3) = ?', hint: 'ลบผ้าที่ตัดทั้งสองชิ้นออก', ops: ['-'] }),
  () => ({ question: 'คนต่อเลโก้ มีตัวต่อ 1,000 ชิ้น ต่อเป็นปราสาทใช้ 600 ชิ้น ต่อเป็นรถใช้ 150 ชิ้น เหลือตัวต่อกี่ชิ้น?', answer: 250, symbolic: '1,000 - 600 - 150 = ?', symbolicAlt: '1,000 - (600 + 150) = ?', hint: 'ลบที่ใช้ทั้งสองชิ้นออก', ops: ['-'] }),
  () => ({ question: 'มังกรพ่นไฟ เผาป่าปีศาจไป 100 ไร่ วันต่อมาเผาได้น้อยกว่าเดิม 20 ไร่ รวมสองวันมังกรเผาป่าไปกี่ไร่?', answer: 180, symbolic: '100 + (100 - 20) = ?', symbolicAlt: '100 + 80 = ?', hint: 'วันที่สอง = 100-20 แล้วรวมทั้งสองวัน', ops: ['+', '-'] }),
  () => ({ question: 'นักปั่นจักรยาน ปั่นวันละ 20 กิโลเมตร เป็นเวลา 6 วัน วันอาทิตย์ปั่นเพิ่มอีก 30 กิโลเมตร รวม 1 สัปดาห์ปั่นได้กี่กิโลเมตร?', answer: 150, symbolic: '(20 × 6) + 30 = ?', hint: 'คูณวันปกติ 6 วันแล้วบวกวันอาทิตย์', ops: ['+', '*'] }),
  () => ({ question: 'พี่เอก ขี่จักรยานไปตลาด 2,000 เมตร ขากลับแวะร้านค้าอ้อมไปอีก 500 เมตร รวมระยะทางไปกลับกี่เมตร?', answer: 4500, symbolic: '2,000 + 2,000 + 500 = ?', hint: 'ขาไป + ขากลับ + ระยะอ้อม', ops: ['+'] }),
];

// Helper: pick random template without repeats
export const pickTemplates = (
  pool: MathTemplate[],
  count: number,
  allowedOps: string[],
  usedIndices: Set<number>
): { result: TemplateResult; index: number }[] => {
  // Filter by ops
  const eligible = pool
    .map((t, i) => ({ t, i }))
    .filter(({ i }) => !usedIndices.has(i));

  // Try to match ops; if none match, return all eligible
  const opsMatched = eligible.filter(({ t }) => {
    const r = t();
    return r.ops.some(op => allowedOps.includes(op));
  });

  const source = opsMatched.length > 0 ? opsMatched : eligible;

  const results: { result: TemplateResult; index: number }[] = [];
  const shuffled = [...source].sort(() => Math.random() - 0.5);

  for (let i = 0; i < Math.min(count, shuffled.length); i++) {
    const { t, i: idx } = shuffled[i];
    results.push({ result: t(), index: idx });
    usedIndices.add(idx);
  }

  return results;
};
